# MP3Player for M5Stack Tab5

SDカード上のMP3ファイルをM5Stack Tab5（M5Unified）で再生するためのタッチUI付きプレーヤーです。`MP3Player.ino` をTab5へ書き込むだけで、ファイル一覧表示・選択・再生制御を行えます。

## 必要環境

- ハードウェア: M5Stack Tab5、microSDカード（FAT32）
- ソフトウェア: Arduino IDE 2.x 以上 + ESP32ボードパッケージ、M5Unified、ESP8266Audio（earlephilhower版）
- SDカード: ルート直下に英数字ファイル名の `.mp3` を配置（最大100件まで検出）

## 操作方法

| 操作エリア | タッチ操作 | 動作 |
|-----------|------------|------|
| ファイルリスト | リスト上の項目をタップ | そのファイルを即再生し、ヘッダーにファイル名を表示 |
| リスト上で上下スワイプ | 見えていないファイルをスクロール（最大15行表示） |
| ボタンエリア左端 `[◀◀]` | 1つ前のファイルに移動して再生 |
| ボタンエリア中央左 `[⏹]` | 再生停止（選択状態は維持） |
| ボタンエリア中央右 `[▶▶]` | 1つ後ろのファイルに移動して再生 |
| ボタンエリア右 `[🔉-]` / `[🔊+]` | 音量を 1 ステップずつ下げる / 上げる（0〜255） |

### 画面の見かた

1. **ヘッダー**: アプリ名と検出したMP3数を表示。
2. **状態行**: `▶ Playing / ⏸ Paused / ⏹ Stopped` を表示し、再生中はファイル名を末尾に表示。
3. **ファイルリスト**: 選択中の行はシアンでハイライトされ、行頭に `> ` が付きます。
4. **ボタンエリア**: 白線より下にあるテキストボタンをタップして各種操作を行います。

### 既知の注意点

- Tab5同梱フォントは絵文字/特殊文字を収録していないため、UIのアイコンが豆腐表示になる場合があります。必要に応じてASCII記号に置き換えてください。
- 日本語ファイル名はSDの8.3形式で化けるため、ファイル名は英数字にするか、SdFat＋UTF-8変換を実装してください。
- Tab5で音が出ない場合は `M5.config()` の `external_speaker.module_display = true` を有効化し、`M5.Speaker.setChannelVolume()` で実音量を上げてください。

## インストール手順

1. `MP3Player` フォルダを Arduino のスケッチフォルダに配置。
2. Arduino IDEで `MP3Player.ino` を開く。
3. ツール → ボード で Tab5 対応ESP32ボード（例: `M5Stack-Tab5`）を選択。
4. ライブラリマネージャから **M5Unified** と **ESP8266Audio** をインストール。
5. Tab5をUSB接続し、スケッチを書き込む。
6. microSDカードにMP3を入れてTab5に挿入すると自動で読み込まれます。

## 参考

- `SPECIFICATION.md`: 詳細仕様やUIのモック
- `MP3Player.ino`: 実装コード（UI描画・タッチ処理・MP3再生ロジック）

ご不明点や改善案があれば README 末尾にコメントを追記してください。

